<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Invoice – Hello Notes</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>
body{
  font-family:'Poppins', sans-serif;
  background:#f5f7fb;
}

.invoice{
  width:800px;
  margin:auto;
  background:#fff;
  padding:20px;
  border-radius:8px;
}

/* ================= FIX START ================= */

.items-table{
  width:100%;
  border-collapse:collapse;
  margin-bottom:260px; /* IMPORTANT */
}

.items-table th, .items-table td{
  border:1px solid #ccc;
  padding:8px;
  text-align:center;
}

.total-box{
  width:300px;
  float:right;
  clear:both;
  position:relative;
  margin-top:20px;
  border:2px solid #e3c97a;
  padding:15px;
  background:#fff7ec;
  page-break-inside:avoid;
}

table, tr, td{
  page-break-inside:avoid !important;
}

/* ================= FIX END ================= */

.header{
  text-align:center;
  margin-bottom:20px;
}

.header h1{
  margin:0;
  color:#2d3fa4;
}
</style>
</head>

<body>

<div class="invoice" id="invoice">

  <div class="header">
    <h1>Hello Notes</h1>
    <div>GST: 29AFQFS5154Q1ZU</div>
    <div>No.6 Kurubarahalli Main Road, Kirloskar Layout</div>
    <div>Bengaluru – 570079 | Phone: 8073431538</div>
  </div>

  <table class="items-table">
    <thead>
      <tr style="background:#2d3fa4;color:#fff;">
        <th>Item</th>
        <th>Qty</th>
        <th>Rate</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody>
      <!-- EXISTING ROW LOGIC UNTOUCHED -->
      <tr><td>A</td><td>10</td><td>500</td><td>5000.00</td></tr>
      <tr><td></td><td>1</td><td>0</td><td>0.00</td></tr>
      <tr><td></td><td>1</td><td>0</td><td>0.00</td></tr>
      <tr><td></td><td>1</td><td>0</td><td>0.00</td></tr>
      <tr><td></td><td>1</td><td>0</td><td>0.00</td></tr>
      <tr><td></td><td>1</td><td>0</td><td>0.00</td></tr>
      <tr><td></td><td>1</td><td>0</td><td>0.00</td></tr>
      <tr><td></td><td>1</td><td>0</td><td>0.00</td></tr>
      <tr><td></td><td>1</td><td>0</td><td>0.00</td></tr>
      <tr><td></td><td>1</td><td>0</td><td>0.00</td></tr>
    </tbody>
  </table>

  <div class="total-box">
    <div>Subtotal: ₹5000.00</div>
    <div>Discount: 0%</div>
    <div>GST 9%</div>
    <div>CGST: ₹225.00</div>
    <div>SGST: ₹225.00</div>
    <strong>Grand Total: ₹5450.00</strong>
    <div style="margin-top:10px;font-size:13px;">
      Amount in words: Five Thousand Four Hundred Fifty Only
    </div>
  </div>

</div>

</body>
</html>.right input,.right select{width:90px;}
.grand{font-size:17px;font-weight:600;color:#2f36b3;}
.words{
  font-style:italic;
  min-height:32px;
  max-height:32px;
  overflow:hidden;
}

/* ACTIONS */
.actions{margin-top:12px;}
button{
  background:#2f36b3;
  color:#fff;
  border:none;
  padding:7px 12px;
  border-radius:6px;
  cursor:pointer;
}

/* PRINT */
@media print{
  .no-print{display:none!important;}
  .invoice{border:none;}
}

/* PAGE */
@page{
  size:A4;
  margin:10mm;
}

tr,td,th{
  page-break-inside:avoid!important;
}
  /* ===== ABSOLUTE FINAL PRINT FIX ===== */

/* Force A4 no matter what user selects */
@media print {

  @page {
    size: A4 portrait;
    margin: 10mm;
  }

  /* Slight scale down to fit LETTER fallback */
  body {
    zoom: 0.94;
  }

  /* Ensure invoice never exceeds page height */
  .invoice {
    max-height: 277mm;
    overflow: hidden;
  }

  /* Lock totals inside page */
  .totals {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }
}
</style>
</head>

<body>

<div class="invoice" id="invoice">

<div class="header">
  <div class="logo">
    <img src="LOGO.jpg">
  </div>
  <div class="header-text">
    <h1>Hello Notes</h1>
    <p><b>GST:</b> 29AFQFS5154Q1ZU</p>
    <p>No.6 Kurubarahalli Main Road, Kirloskar Layout</p>
    <p>Bengaluru – 570079 | Phone: 8073431538</p>
  </div>
</div>

<div class="line"></div>

<div class="grid2">
  <div><label>Invoice Number</label><input></div>
  <div><label>Invoice Date</label><input type="date"></div>
</div>

<div class="mt10">
  <label>Customer Name</label>
  <input>
</div>

<table id="items">
<thead>
<tr>
  <th>Item</th><th>Qty</th><th>Rate</th><th>Total</th>
  <th class="no-print"></th>
</tr>
</thead>
<tbody></tbody>
</table>

<button class="no-print" onclick="addRow()">+ Add Item</button>

<div class="totals">
  <div class="row"><span>Subtotal</span><span id="sub">₹0.00</span></div>

  <div class="row" id="discountRow">
    <span>Discount</span>
    <span class="right">
      <input id="disc" value="0" oninput="calc()">
      <select id="discType" onchange="calc()">
        <option>%</option>
        <option>₹</option>
      </select>
    </span>
  </div>

  <div class="row">
    <span>GST Base</span>
    <select id="gstBase" onchange="calc()">
      <option value="subtotal">On Subtotal</option>
      <option value="discount">After Discount</option>
    </select>
  </div>

  <div class="row">
    <span>GST %</span>
    <input id="gst" value="9" oninput="calc()">
  </div>

  <div class="row"><span>CGST</span><span id="cgst">₹0.00</span></div>
  <div class="row"><span>SGST</span><span id="sgst">₹0.00</span></div>

  <div class="row grand"><span>Grand Total</span><span id="grand">₹0.00</span></div>
  <div class="words" id="words">Amount in words: Rupees Only</div>
</div>

<div class="actions no-print">
  <button onclick="downloadPDF()">Download PDF</button>
  <button onclick="window.print()">Print</button>
</div>

</div>

<script>
const tbody=document.querySelector("#items tbody");

function addRow(){
  const tr=document.createElement("tr");
  tr.innerHTML=`
    <td><input></td>
    <td><input type="number" value="1" oninput="calc()"></td>
    <td><input type="number" value="0" oninput="calc()"></td>
    <td class="rt">0.00</td>
    <td class="no-print"><button onclick="this.closest('tr').remove();calc()">X</button></td>
  `;
  tbody.appendChild(tr);
  calc();
}

function numToWords(n){
  const a=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten",
  "Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"];
  const b=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];
  if(n<20) return a[n];
  if(n<100) return b[Math.floor(n/10)]+" "+a[n%10];
  if(n<1000) return a[Math.floor(n/100)]+" Hundred "+numToWords(n%100);
  if(n<100000) return numToWords(Math.floor(n/1000))+" Thousand "+numToWords(n%1000);
  if(n<10000000) return numToWords(Math.floor(n/100000))+" Lakh "+numToWords(n%100000);
  return numToWords(Math.floor(n/10000000))+" Crore "+numToWords(n%10000000);
}

function calc(){
  let subtotal=0;
  document.querySelectorAll(".rt").forEach(c=>{
    const r=c.parentElement;
    const q=+r.children[1].children[0].value||0;
    const rate=+r.children[2].children[0].value||0;
    const t=q*rate;
    c.innerText=t.toFixed(2);
    subtotal+=t;
  });

  sub.innerText="₹"+subtotal.toFixed(2);

  let d=+disc.value||0;
  let discount=discType.value=="%"?subtotal*d/100:d;

  let base=gstBase.value=="discount"?subtotal-discount:subtotal;
  let gstAmt=base*(+gst.value/100);

  cgst.innerText="₹"+(gstAmt/2).toFixed(2);
  sgst.innerText="₹"+(gstAmt/2).toFixed(2);

  let total=base+gstAmt;
  grand.innerText="₹"+total.toFixed(2);
  words.innerText="Amount in words: "+numToWords(Math.round(total))+" Rupees Only";
}

function downloadPDF(){
  document.querySelectorAll(".no-print").forEach(e=>e.style.display="none");
  setTimeout(()=>{
    html2pdf().set({
      filename:'Invoice.pdf',
      jsPDF:{unit:'mm',format:'a4',orientation:'portrait'},
      html2canvas:{scale:2,useCORS:true}
    }).from(invoice).save().then(()=>{
      document.querySelectorAll(".no-print").forEach(e=>e.style.display="");
    });
  },200);
}

addRow();
</script>

</body>
</html>


